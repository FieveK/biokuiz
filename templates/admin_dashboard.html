{% extends "base.html" %}
{% block content %}
<div class="container py-4">

  <h2 class="text-success mb-4">ðŸ“Š Statistik Guru</h2>

  <!-- Summary Cards -->
  <div class="row text-center mb-4">
    <div class="col-md-2">
      <div class="card shadow-sm p-3 bg-light rounded">
        <h4>{{ total_murid }}</h4>
        <p class="text-muted">Murid</p>
      </div>
    </div>
    <div class="col-md-2">
      <div class="card shadow-sm p-3 bg-light rounded">
        <h4>{{ total_guru }}</h4>
        <p class="text-muted">Guru</p>
      </div>
    </div>
    <div class="col-md-2">
      <div class="card shadow-sm p-3 bg-light rounded">
        <h4>{{ total_material }}</h4>
        <p class="text-muted">Materi</p>
      </div>
    </div>
    <div class="col-md-2">
      <div class="card shadow-sm p-3 bg-light rounded">
        <h4>{{ total_questions }}</h4>
        <p class="text-muted">Soal</p>
      </div>
    </div>
    <div class="col-md-2">
      <div class="card shadow-sm p-3 bg-light rounded">
        <h4>{{ avg_scores }}%</h4>
        <p class="text-muted">Rata-rata Nilai</p>
      </div>
    </div>
  </div>

  <!-- Chart Section -->
  <div class="card shadow-sm p-4 mt-4">
    <h5 class="mb-3 text-center">ðŸ“ˆ Performa Nilai Tertinggi Murid</h5>
    <canvas id="scoreChart" height="100"></canvas>
  </div>

    <!-- Grafik Tren Nilai Rata-rata -->
  <div class="card shadow-sm p-4 mt-5">
    <h5 class="mb-3 text-center">ðŸ“‰ Tren Rata-rata Nilai Harian</h5>
    <canvas id="trendChart" height="100"></canvas>
  </div>


  <!-- Tombol CRUD -->
  <div class="text-center mt-5">
    <a href="{{ url_for('admin_material') }}" class="btn btn-success me-3">
      ðŸ“˜ Kelola Materi
    </a>
    <a href="{{ url_for('admin_question') }}" class="btn btn-outline-success">
      ðŸ§  Kelola Soal
    </a>
  </div>

</div>

<!-- Chart.js Script -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
const ctx = document.getElementById('scoreChart').getContext('2d');
const scoreChart = new Chart(ctx, {
  type: 'bar',
  data: {
    labels: {{ labels|tojson }},
    datasets: [{
      label: 'Nilai Tertinggi Murid',
      data: {{ data_scores|tojson }},
      borderWidth: 1,
      backgroundColor: 'rgba(75, 192, 192, 0.5)',
      borderColor: 'rgba(75, 192, 192, 1)'
    }]
  },
  options: {
    scales: {
      y: {
        beginAtZero: true,
        title: { display: true, text: 'Skor (%)' }
      },
      x: {
        title: { display: true, text: 'Nama Murid' }
      }
    },
    plugins: {
      legend: { display: false },
      tooltip: { enabled: true }
    }
  }
});

const ctx2 = document.getElementById('trendChart').getContext('2d');
const trendChart = new Chart(ctx2, {
  type: 'line',
  data: {
    labels: {{ line_labels|tojson }},
    datasets: [{
      label: 'Rata-rata Nilai (%)',
      data: {{ line_data|tojson }},
      borderColor: 'rgba(54, 162, 235, 1)',
      backgroundColor: 'rgba(54, 162, 235, 0.2)',
      fill: true,
      tension: 0.4,
      pointRadius: 5,
      pointBackgroundColor: 'rgba(54,162,235,1)',
    }]
  },
  options: {
    scales: {
      y: {
        beginAtZero: true,
        title: { display: true, text: 'Nilai Rata-rata' }
      },
      x: {
        title: { display: true, text: 'Tanggal' }
      }
    },
    plugins: {
      legend: { position: 'bottom' },
      tooltip: { enabled: true }
    }
  }
});

</script>
{% endblock %}
